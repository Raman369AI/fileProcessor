# ============================================================================
# Email Monitor with Redis Queue - Environment Configuration
# ============================================================================

# ============================================================================
# REQUIRED: Microsoft Azure AD Configuration
# ============================================================================
AZURE_CLIENT_ID=your_azure_app_client_id
AZURE_CLIENT_SECRET=your_azure_app_client_secret
AZURE_TENANT_ID=your_azure_tenant_id

# ============================================================================
# Email Monitoring Configuration
# ============================================================================
# Comma-separated list of email groups/domains to monitor
EMAIL_GROUPS=company.com,partner.org,notifications@service.com

# Supported file types to process (comma-separated with dots)
FILE_TYPES=.pdf,.docx,.xlsx,.csv,.txt,.jpg,.png

# Directory to save attachments and processing results
ATTACHMENTS_DIR=email_attachments

# ============================================================================
# Redis Queue Configuration (Optional)
# ============================================================================
# Enable Redis queue for attachment processing
USE_REDIS_QUEUE=true

# Redis connection settings
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Queue configuration
EMAIL_QUEUE_NAME=email_attachments
MAX_QUEUE_SIZE=1000
MAX_ATTACHMENT_SIZE=52428800  # 50MB in bytes

# Processing limits and timeouts
WORKER_TIMEOUT=300         # 5 minutes
WORKER_RESULT_TTL=3600     # 1 hour
WORKER_FAILURE_TTL=86400   # 24 hours
DEFAULT_MAX_RETRIES=3

# ============================================================================
# Application Configuration
# ============================================================================
# FastAPI server settings
HOST=0.0.0.0
PORT=8000
LOG_LEVEL=info

# ============================================================================
# Email Processing Schedule
# ============================================================================
# Email check interval (in minutes) - configured in main.py
# Default: every 5 minutes

# ============================================================================
# Example Redis Queue Usage
# ============================================================================
# When USE_REDIS_QUEUE=true, attachments are enqueued with:
# - Email metadata (ID, subject, sender, date)
# - Attachment content (base64 encoded)
# - MIME type information
# - File size and metadata
#
# Queue items can be consumed by external workers or monitoring systems
#
# API Endpoints for queue management:
# GET  /redis-queue/status - Queue status and info
# GET  /redis-queue/stats  - Detailed queue statistics  
# GET  /redis-queue/peek   - Preview queue items
# POST /redis-queue/clear  - Clear all queue items
# GET  /redis-queue/health - Health check

# ============================================================================
# Security Notes
# ============================================================================
# - Keep your Azure credentials secure and rotate regularly
# - Use Redis AUTH if Redis is network accessible
# - Consider Redis SSL/TLS for production environments
# - Limit Redis access with firewall rules
# - Monitor queue size to prevent memory issues

# ============================================================================
# Performance Tuning
# ============================================================================
# Adjust these based on your environment:
# - MAX_QUEUE_SIZE: Larger for high email volume
# - MAX_ATTACHMENT_SIZE: Larger for bigger files (watch memory usage)
# - WORKER_TIMEOUT: Longer for complex processing
# - Redis memory configuration (maxmemory, maxmemory-policy)

# ============================================================================
# Monitoring and Alerting
# ============================================================================
# Monitor these metrics:
# - Queue length (/redis-queue/stats)
# - Processing errors (application logs)
# - Redis memory usage
# - Failed jobs count
# - Email processing latency